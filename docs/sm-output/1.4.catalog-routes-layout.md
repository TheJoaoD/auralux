# Story 1.4: Criar Estrutura de Rotas e Layout do Catálogo Público

## Status
**Ready for Review**

## Story

**As a** desenvolvedor,
**I want** criar estrutura de rotas Next.js para o catálogo público com layout base,
**so that** tenhamos fundação para implementar páginas do catálogo.

## Acceptance Criteria

1. Diretório `/app/catalogo` criado com arquivo `layout.tsx`
2. Layout do catálogo (`/app/catalogo/layout.tsx`) inclui: header público (logo, busca, carrinho), footer, navegação sticky
3. Layout do catálogo não inclui menu lateral administrativo do Auralux
4. Layout do catálogo usa paleta de cores diferenciada (tons neutros + acentos dourados)
5. Arquivo `/app/catalogo/page.tsx` criado como página inicial (home do catálogo)
6. Home do catálogo renderiza placeholder "Bem-vindo ao Catálogo Auralux" (implementação completa em Epic 2)
7. Arquivo `/app/catalogo/produto/[id]/page.tsx` criado como página de detalhes (implementação completa em Epic 2)
8. Arquivo `/app/catalogo/favoritos/page.tsx` criado (protegido por middleware)
9. Arquivo `/app/catalogo/carrinho/page.tsx` criado (protegido por middleware)
10. Componente `/components/catalog/CatalogHeader.tsx` criado com logo, busca (placeholder), ícone carrinho com contador
11. Componente `/components/catalog/CatalogFooter.tsx` criado com links institucionais e redes sociais
12. Arquivo `/types/catalog.ts` criado com types: `CatalogUser`, `CatalogItem`, `CatalogFavorite`, `CatalogCart`, `CatalogRequest`
13. Navegação funcional entre páginas do catálogo usando `next/link`
14. Middleware redireciona usuários não autenticados de `/catalogo/favoritos` e `/catalogo/carrinho` para modal de login

## Tasks / Subtasks

- [x] **Task 1: Criar estrutura de diretórios** (AC: 1, 5, 7-9)
  - [x] Criar `/app/catalogo/layout.tsx`
  - [x] Criar `/app/catalogo/page.tsx` (placeholder)
  - [x] Criar `/app/catalogo/produto/[id]/page.tsx` (placeholder)
  - [x] Criar `/app/catalogo/favoritos/page.tsx`
  - [x] Criar `/app/catalogo/carrinho/page.tsx`

- [x] **Task 2: Implementar CatalogHeader** (AC: 10)
  - [x] Criar `/components/catalog/CatalogHeader.tsx`
  - [x] Logo Auralux
  - [x] Input de busca (placeholder)
  - [x] Ícone carrinho com contador badge

- [x] **Task 3: Implementar CatalogFooter** (AC: 11)
  - [x] Criar `/components/catalog/CatalogFooter.tsx`
  - [x] Links institucionais
  - [x] Redes sociais

- [x] **Task 4: Implementar Layout** (AC: 2-4)
  - [x] Compor layout com Header + children + Footer
  - [x] Aplicar paleta de cores catálogo
  - [x] Garantir não há menu lateral admin

- [x] **Task 5: Criar TypeScript types** (AC: 12)
  - [x] Criar `/types/catalog.ts`
  - [x] Definir todas as interfaces

- [x] **Task 6: Configurar middleware de proteção** (AC: 14)
  - [x] Editar `/middleware.ts`
  - [x] Proteger rotas `/catalogo/favoritos` e `/catalogo/carrinho`

## Dev Notes

**[Source: docs/architecture/appendix-folder-structure.md]**

### Estrutura Final:
```
app/
  catalogo/
    layout.tsx               # Layout base
    page.tsx                 # Home (placeholder)
    produto/[id]/page.tsx   # Detalhes (placeholder)
    favoritos/page.tsx      # Protegido
    carrinho/page.tsx       # Protegido
    actions/
      auth.ts                # Server Actions (Story 1.3)

components/
  catalog/
    CatalogHeader.tsx
    CatalogFooter.tsx

types/
  catalog.ts               # TypeScript interfaces
```

### Layout Pattern:
```tsx
export default function CatalogLayout({ children }) {
  return (
    <div className="min-h-screen bg-[#FAFAF8]">
      <CatalogHeader />
      <main>{children}</main>
      <CatalogFooter />
    </div>
  )
}
```

### Middleware Protection:
```typescript
// middleware.ts
export function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl
  
  if (pathname.startsWith('/catalogo/favoritos') || pathname.startsWith('/catalogo/carrinho')) {
    const token = request.cookies.get('catalog_token')
    
    if (!token) {
      // Redirect to home with modal trigger
      return NextResponse.redirect(new URL('/catalogo?auth=required', request.url))
    }
  }
  
  return NextResponse.next()
}
```

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-09 | v1.0 | Created | Bob (SM) |

## Dev Agent Record

### Agent Model Used

**Model:** Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)
**Agent:** James (Dev Agent)
**Date:** 2025-11-09

### Debug Log References

No debug logs required - layout structure implemented successfully.

### Completion Notes List

**Implementation Summary:**
1. ✅ Created complete catalog route structure
2. ✅ Implemented CatalogHeader with search, cart, favorites
3. ✅ Implemented CatalogFooter with social links
4. ✅ Created catalog layout with Header/Footer composition
5. ✅ Created 5 page files (home, product details, favorites, cart)
6. ✅ Created comprehensive TypeScript types in `/types/catalog.ts`
7. ✅ Middleware protection already implemented in Story 1.3

**Files Structure:**
```
app/catalogo/
├── layout.tsx (main layout)
├── page.tsx (home placeholder)
├── produto/[id]/page.tsx (product details placeholder)
├── favoritos/page.tsx (protected)
├── carrinho/page.tsx (protected)
└── actions/auth.ts (from Story 1.3)

components/catalog/
├── CatalogHeader.tsx (search, cart, user menu)
└── CatalogFooter.tsx (links, social)

types/
└── catalog.ts (11 types + extended types)
```

**Design System:**
- Background: #FAFAF8 (off-white)
- Primary: Amber gradient (600-400)
- Text: Gray scale
- Cards: White with subtle borders
- No admin sidebar (isolated catalog layout)

**Features Implemented:**
- Responsive header with mobile/desktop layouts
- Search bar (placeholder for Epic 2)
- Cart counter badge
- Navigation links
- Social media integration
- Protected routes with middleware redirect

**Challenges:**
None - straightforward layout implementation.

### File List

**Files Created:**
- `types/catalog.ts` - All catalog TypeScript types
- `components/catalog/CatalogHeader.tsx` - Public header
- `components/catalog/CatalogFooter.tsx` - Public footer
- `app/catalogo/layout.tsx` - Main layout
- `app/catalogo/page.tsx` - Home placeholder
- `app/catalogo/produto/[id]/page.tsx` - Product details placeholder
- `app/catalogo/favoritos/page.tsx` - Favorites (protected)
- `app/catalogo/carrinho/page.tsx` - Cart (protected)

**Files Modified:**
- `docs/sm-output/1.4.catalog-routes-layout.md` - Story completed

## QA Results

*To be filled by QA Agent after implementation review*
