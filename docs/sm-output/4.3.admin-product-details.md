# Story 4.3: Implementar Formulário de Detalhes Extras do Produto

## Status
**Draft**

## Story

**As a** gestor,
**I want** adicionar detalhes extras aos produtos (notas de fragrância, ocasião, intensidade, durabilidade),
**so that** clientes tenham informações completas no catálogo público.

## Acceptance Criteria

1-2. Página /catalogo-admin/produtos/[id]/editar com formulário
3. Campos: Notas (top/heart/base), Ocasião (multi), Intensidade, Durabilidade, Data Retorno
4. Salvar atualiza catalog_items
5. Preview abre /catalogo/produto/[id] em nova aba
6. Toast sucesso
7. Validações: max 500 chars, min 1 ocasião
8. Aviso se produto não visível
9. Preview em tempo real abaixo do form
10. Botão limpar
11. E2E: salvar → público atualiza
12. Integration: RLS admin only

## Tasks / Subtasks

- [ ] **Task 1: Formulário** (AC: 1-4, 7)
  - [ ] Form com react-hook-form
  - [ ] Textareas, Select, MultiSelect
  - [ ] Validação zod

- [ ] **Task 2: Save logic** (AC: 4, 6)
  - [ ] Mutation upsert catalog_items
  - [ ] Toast

- [ ] **Task 3: Preview** (AC: 5, 9)
  - [ ] Botão nova aba
  - [ ] Preview real-time abaixo form

- [ ] **Task 4: UX** (AC: 8, 10)
  - [ ] Alert se não visível
  - [ ] Limpar campos

- [ ] **Task 5: Testes** (AC: 11-12)

## Dev Notes

Form schema:
```typescript
const schema = z.object({
  fragrance_notes_top: z.string().max(500),
  fragrance_notes_heart: z.string().max(500),
  fragrance_notes_base: z.string().max(500),
  occasion: z.array(z.string()).min(1),
  intensity: z.enum(['suave', 'moderada', 'forte']),
  longevity: z.enum(['curta', 'media', 'longa', 'muito_longa']),
  stock_return_date: z.date().optional()
})
```

**Dependencies**: Story 4.2

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-09 | v1.0 | Created | Bob (SM) |
